<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Режим пользователя</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }

        #filter {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: white;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 20;
        }

        #filter label {
            margin-right: 10px;
        }

        #filter select {
            padding: 5px;
        }

        #container {
            margin-top: 100px;
            position: relative;
            display: inline-block;
        }

        #image {
            display: block;
            max-width: 100%;
            height: auto;
        }

        .circle {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            background-color: green; /* Все круги зелёные */
            z-index: 10;
        }

        .blink {
            animation: blink-yellow 1s infinite;
        }

        @keyframes blink-yellow {
            0%, 50% { background-color: green; }
            25%, 75% { background-color: yellow; }
        }
    </style>
</head>
<body>
    <!-- Фильтр для выбора круга -->
    <div id="filter">
        <label for="circle-select">Выберите круг:</label>
        <select id="circle-select">
            <option value="">-- Выберите --</option>
        </select>
    </div>

    <!-- Контейнер с картинкой и кругами -->
    <div id="container">
        <img id="image" src="my-image.jpg" alt="Картинка">
    </div>

    <script>
        const select = document.getElementById('circle-select');
        const container = document.getElementById('container');

        function createCircle(id, top = '50%', left = '50%') {
            const circle = document.createElement('div');
            circle.id = id;
            circle.className = 'circle';
            circle.style.top = top;
            circle.style.left = left;
            container.appendChild(circle);
            return circle;
        }

        function saveDefaultCircles() {
            const circles = document.querySelectorAll('.circle');
            const circleIds = [];
            circles.forEach(circle => {
                const id = circle.id;
                circleIds.push(id);
                const top = circle.style.top || '50%';
                const left = circle.style.left || '50%';
                localStorage.setItem(id, JSON.stringify({ top, left }));
            });
            localStorage.setItem('circles', JSON.stringify(circleIds));
        }

        function loadCircles() {
            const savedCircles = localStorage.getItem('circles');
            if (savedCircles) {
                const circleIds = JSON.parse(savedCircles);
                circleIds.forEach(id => {
                    const savedPos = localStorage.getItem(id);
                    let top = '50%', left = '50%';
                    if (savedPos) {
                        ({ top, left } = JSON.parse(savedPos));
                    }
                    createCircle(id, top, left);
                });
            } else {
                // Дефолтные круги, если ничего не сохранено
                createCircle('circle1', '10%', '10%');
                createCircle('circle2', '50%', '50%');
                createCircle('circle3', '80%', '80%');
                saveDefaultCircles(); // Сохраняем дефолтные в localStorage
            }
            updateSelect();
        }

        function updateSelect() {
            select.innerHTML = '<option value="">-- Выберите --</option>';
            document.querySelectorAll('.circle').forEach(circle => {
                const option = document.createElement('option');
                option.value = circle.id;
                option.textContent = circle.id.replace('circle', 'Круг ');
                select.appendChild(option);
            });
        }

        function resetBlinks() {
            document.querySelectorAll('.circle').forEach(circle => circle.classList.remove('blink'));
        }

        select.addEventListener('change', (event) => {
            resetBlinks();
            const selectedValue = event.target.value;
            if (selectedValue) {
                const selectedCircle = document.getElementById(selectedValue);
                if (selectedCircle) {
                    selectedCircle.classList.add('blink');
                }
            }
        });

        loadCircles();
    </script>
</body>
</html>
